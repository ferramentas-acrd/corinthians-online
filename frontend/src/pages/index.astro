---
export const prerender = false;

import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import { getHomePagePostsOptimized, convertToLegacyFormat } from '../lib/strapi-optimized';

let posts = [];
try {
  const strapiPosts = await getHomePagePostsOptimized(12);
  posts = convertToLegacyFormat(strapiPosts);
} catch (error) {
  console.error('Error fetching posts:', error);
  // Use placeholder data when Strapi is not available
  posts = [];
}

// Placeholder data for when Strapi doesn't have content yet
const placeholderPosts = [
  {
    title: "Real Madrid sofre sua pior derrota em casa nos últimos 10 anos",
    excerpt: "Time merengue é goleado pelo Barcelona por 4x0 no Santiago Bernabéu e vê rival disparar na liderança do campeonato espanhol.",
    author: "Pedro Costa",
    category: { name: "Champions League" },
    slug: "real-madrid-derrota-barcelona",
    date: new Date().toISOString()
  },
  {
    title: "Palmeiras anuncia novo técnico português",
    excerpt: "Direção alviverde confirma contratação de treinador europeu para a temporada 2025.",
    author: "Ana Santos",
    category: { name: "Brasileirão" },
    slug: "palmeiras-novo-tecnico",
    date: new Date().toISOString()
  },
  {
    title: "Liverpool vence clássico e assume liderança",
    excerpt: "Reds superam Manchester City em Anfield e voltam ao topo da Premier League.",
    author: "Carlos Lima",
    category: { name: "Premier League" },
    slug: "liverpool-vence-city",
    date: new Date().toISOString()
  },
  {
    title: "Brasil convoca para eliminatórias",
    excerpt: "Técnico da seleção divulga lista com 23 jogadores para próximos compromissos.",
    author: "Roberto Silva",
    category: { name: "Seleção" },
    slug: "brasil-convocacao",
    date: new Date().toISOString()
  }
];

// Use Strapi data if available, otherwise use placeholders
const finalPosts = posts.length > 0 ? posts : placeholderPosts;

// Get featured post from Strapi or use fallback
const featuredPost = finalPosts.find(post => post.featured) || {
  title: "Flamengo vence Corinthians e dispara na liderança do Brasileirão",
  excerpt: "Com gols de Pedro e Arrascaeta, time carioca abre 5 pontos de vantagem e encaminha título. Análise completa do jogo e as melhores apostas para a próxima rodada.",
  author: "João Silva",
  readTime: "5",
  slug: "flamengo-vence-corinthians"
};

const latestPosts = finalPosts.slice(0, 4);
---

<Layout title="Corinthians Online - A casa de apostas oficial da Fiel Torcida">
  <Header />
  
  <main class="flex-1">
    <!-- Betting Houses Section -->
    <div class="bg-gray-100 py-12">
      <div class="max-w-7xl mx-auto px-4">
        <h2 class="text-3xl font-bold text-center mb-8">Melhores Casas de Apostas Parceiras</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <!-- bet365 -->
          <div class="bg-white rounded-lg p-6 border border-gray-200">
            <div class="flex items-center justify-between mb-4">
              <span class="bg-black text-white px-3 py-1 rounded text-sm font-bold">
                01
              </span>
              <div class="flex text-yellow-400 text-sm">
                ★★★★★ 4.9
              </div>
            </div>
            <h3 class="text-xl font-bold mb-2">bet365</h3>
            <p class="text-gray-600 mb-4">100% até R$500 no primeiro depósito</p>
            
            <ul class="space-y-2 mb-6">
              <li class="flex items-center text-sm">
                <span class="text-green-600 mr-2">✓</span>
                Odds competitivas
              </li>
              <li class="flex items-center text-sm">
                <span class="text-green-600 mr-2">✓</span>
                Streaming ao vivo
              </li>
              <li class="flex items-center text-sm">
                <span class="text-green-600 mr-2">✓</span>
                Cash out disponível
              </li>
            </ul>
            
            <div class="flex gap-3">
              <button class="flex-1 bg-gray-200 text-gray-800 py-2 px-4 rounded font-medium hover:bg-gray-300 transition-colors">
                Cadastrar
              </button>
              <button class="flex-1 border border-gray-300 text-gray-700 py-2 px-4 rounded font-medium hover:bg-gray-50 transition-colors">
                Review
              </button>
            </div>
          </div>

          <!-- Betano -->
          <div class="bg-white rounded-lg p-6 border border-gray-200">
            <div class="flex items-center justify-between mb-4">
              <span class="bg-black text-white px-3 py-1 rounded text-sm font-bold">
                02
              </span>
              <div class="flex text-yellow-400 text-sm">
                ★★★★★ 4.8
              </div>
            </div>
            <h3 class="text-xl font-bold mb-2">Betano</h3>
            <p class="text-gray-600 mb-4">Apostas grátis toda semana</p>
            
            <ul class="space-y-2 mb-6">
              <li class="flex items-center text-sm">
                <span class="text-green-600 mr-2">✓</span>
                SuperOdds diárias
              </li>
              <li class="flex items-center text-sm">
                <span class="text-green-600 mr-2">✓</span>
                App para Android e iOS
              </li>
              <li class="flex items-center text-sm">
                <span class="text-green-600 mr-2">✓</span>
                Promoções exclusivas
              </li>
            </ul>
            
            <div class="flex gap-3">
              <button class="flex-1 bg-gray-200 text-gray-800 py-2 px-4 rounded font-medium hover:bg-gray-300 transition-colors">
                Cadastrar
              </button>
              <button class="flex-1 border border-gray-300 text-gray-700 py-2 px-4 rounded font-medium hover:bg-gray-50 transition-colors">
                Review
              </button>
            </div>
          </div>

          <!-- Sportingbet -->
          <div class="bg-white rounded-lg p-6 border border-gray-200">
            <div class="flex items-center justify-between mb-4">
              <span class="bg-black text-white px-3 py-1 rounded text-sm font-bold">
                03
              </span>
              <div class="flex text-yellow-400 text-sm">
                ★★★★☆ 4.7
              </div>
            </div>
            <h3 class="text-xl font-bold mb-2">Sportingbet</h3>
            <p class="text-gray-600 mb-4">Bônus de até R$750</p>
            
            <ul class="space-y-2 mb-6">
              <li class="flex items-center text-sm">
                <span class="text-green-600 mr-2">✓</span>
                Múltiplas turbinadas
              </li>
              <li class="flex items-center text-sm">
                <span class="text-green-600 mr-2">✓</span>
                Depósito via Pix
              </li>
              <li class="flex items-center text-sm">
                <span class="text-green-600 mr-2">✓</span>
                Suporte 24/7
              </li>
            </ul>
            
            <div class="flex gap-3">
              <button class="flex-1 bg-gray-200 text-gray-800 py-2 px-4 rounded font-medium hover:bg-gray-300 transition-colors">
                Cadastrar
              </button>
              <button class="flex-1 border border-gray-300 text-gray-700 py-2 px-4 rounded font-medium hover:bg-gray-50 transition-colors">
                Review
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Live Betting Section -->
    <div class="bg-white py-12">
      <div class="max-w-7xl mx-auto px-4">
        <h2 class="text-3xl font-bold text-center mb-8">Jogos do Corinthians - Apostas ao Vivo</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <!-- Game 1 -->
          <div class="bg-white border border-gray-200 rounded-lg p-6">
            <div class="flex items-center justify-between mb-4">
              <span class="text-sm text-gray-600">Campeonato Brasileiro</span>
              <span class="bg-red-600 text-white px-3 py-1 rounded text-sm font-bold">
                AO VIVO - 65'
              </span>
            </div>
            
            <div class="text-center mb-6">
              <h3 class="text-lg font-bold mb-2">Corinthians X Palmeiras</h3>
            </div>
            
            <div class="grid grid-cols-3 gap-4 text-center">
              <div class="bg-gray-50 p-3 rounded">
                <div class="text-sm text-gray-600 mb-1">Casa</div>
                <div class="text-xl font-bold">2.45</div>
              </div>
              <div class="bg-gray-50 p-3 rounded">
                <div class="text-sm text-gray-600 mb-1">Empate</div>
                <div class="text-xl font-bold">3.10</div>
              </div>
              <div class="bg-gray-50 p-3 rounded">
                <div class="text-sm text-gray-600 mb-1">Visitante</div>
                <div class="text-xl font-bold">2.85</div>
              </div>
            </div>
          </div>

          <!-- Game 2 -->
          <div class="bg-white border border-gray-200 rounded-lg p-6">
            <div class="flex items-center justify-between mb-4">
              <span class="text-sm text-gray-600">Copa do Brasil</span>
              <span class="bg-blue-600 text-white px-3 py-1 rounded text-sm font-bold">
                Hoje 21:30
              </span>
            </div>
            
            <div class="text-center mb-6">
              <h3 class="text-lg font-bold mb-2">Corinthians X Flamengo</h3>
            </div>
            
            <div class="grid grid-cols-3 gap-4 text-center">
              <div class="bg-gray-50 p-3 rounded">
                <div class="text-sm text-gray-600 mb-1">Casa</div>
                <div class="text-xl font-bold">2.10</div>
              </div>
              <div class="bg-gray-50 p-3 rounded">
                <div class="text-sm text-gray-600 mb-1">Empate</div>
                <div class="text-xl font-bold">3.25</div>
              </div>
              <div class="bg-gray-50 p-3 rounded">
                <div class="text-sm text-gray-600 mb-1">Visitante</div>
                <div class="text-xl font-bold">3.40</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

  </main>

  <Footer />
</Layout>